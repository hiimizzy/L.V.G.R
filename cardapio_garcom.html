<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Card√°pio - L.V.G.R</title>
  <link rel="shortcut icon" href="lua.ico" type="image/x-icon">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            warm: { 
              chocolate: '#4a2010', 
              orange: '#c85a17', 
              cream: '#f5f0e8' 
            },
            brand: { 
              bg: '#f5f0e8', 
              card: '#fdfbf7', 
              border: '#e0d5c5', 
              primary: '#a33a10' 
            }
          }
        }
      }
    }
  </script>
</head>
<body class="bg-brand-bg text-warm-chocolate">

<header class="bg-warm-chocolate text-center py-6 shadow-lg">
  <img src="img/hamb-1.png" alt="logo" class="w-32 h-32 mx-auto rounded-full shadow-lg border-4 border-warm-orange" />
  <h1 class="text-4xl font-bold text-warm-cream mt-2" style="font-family: 'Playfair Display', serif;">L.V.G.R</h1>
  <p class="text-warm-cream opacity-90 mt-2 italic">Fa√ßa seu pedido com carinho ü•ê</p>
</header>

<section class="max-w-4xl mx-auto py-10 px-4">
  <h2 class="text-3xl text-center mb-8 font-bold text-warm-chocolate">Nosso Card√°pio</h2>
  <div id="menu-container" class="grid grid-cols-1 md:grid-cols-2 gap-6">
  </div>
</section>

<section class="max-w-4xl mx-auto px-4 pb-10">
  <h2 class="text-2xl font-bold text-center mb-6 text-warm-chocolate">Seu Carrinho</h2>
  <div class="overflow-hidden rounded-xl border border-brand-border shadow-md">
    <table class="w-full bg-brand-card text-center text-warm-chocolate">
      <thead class="bg-warm-orange text-white">
        <tr>
          <th class="py-3 px-4">Item</th>
          <th class="py-3">Qtd</th>
          <th class="py-3">Pre√ßo</th>
          <th class="py-3 px-4">A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="carrinho-corpo" class="divide-y divide-brand-border">
        </tbody>
    </table>
  </div>
  
  <p id="total-carrinho" class="text-right mt-4 font-bold text-xl text-brand-primary">Total: R$ 0,00</p>
  
  <div class="text-center mt-8 bg-brand-card p-6 rounded-xl border border-brand-border shadow-sm">
    <div class="mb-6 max-w-xs mx-auto">
      <label for="mesa-select" class="block text-warm-chocolate font-bold mb-2 uppercase text-xs tracking-wider">Selecione a Mesa:</label>
      <select id="mesa-select" class="w-full p-3 rounded-lg border-2 border-brand-border bg-white text-warm-chocolate focus:border-warm-orange outline-none transition-colors">
      </select>
    </div>
    <button id="confirmar-pedido" class="bg-brand-primary text-white px-10 py-3 rounded-xl font-bold text-lg hover:bg-warm-chocolate transition-all transform active:scale-95 shadow-lg">
      Confirmar Pedido ü•ñ
    </button>
  </div>
</section>

<script src="api.js"></script>
<script>
  // O seu script original permanece EXATAMENTE o mesmo, 
  // apenas atualizei a fun√ß√£o de renderiza√ß√£o do card√°pio para usar as cores novas nos cards:

  async function renderizarCardapio() {
    const container = document.getElementById('menu-container');
    container.innerHTML = '<p class="text-center col-span-full">Carregando card√°pio...</p>';

    const itensCardapio = await getProducts();

    if (itensCardapio === null) {
        container.innerHTML = '<p class="text-center col-span-full text-red-500 font-bold">Erro ao conectar com o servidor.</p>';
        return;
    }

    allProducts = itensCardapio;
    container.innerHTML = '';

    itensCardapio.forEach(item => {
      const card = document.createElement('div');
      // Cores do card ajustadas para Creme e Borda de Caf√©
      card.className = 'bg-brand-card text-warm-chocolate p-4 rounded-xl border border-brand-border shadow-sm hover:shadow-md transition-shadow';

      card.innerHTML = `
        <img src="${item.imgUrl}" alt="${item.nome}" class="w-full h-44 object-cover rounded-lg mb-4" />
        <h3 class="text-xl font-bold">${item.nome}</h3>
        <p class="text-sm text-gray-600 h-10 overflow-hidden">${item.descricao || ''}</p>
        <div class="flex justify-between items-center mt-4">
            <p class="text-lg font-bold text-brand-primary">${formatarPreco(item.price)}</p>
            <button class="adicionar-btn bg-warm-orange text-white px-4 py-2 rounded-lg hover:bg-brand-primary transition-colors text-sm font-bold"
                    data-id="${item.id}"
                    data-nome="${item.nome}"
                    data-preco="${item.price}">
              ADICIONAR üõí
            </button>
        </div>
      `;
      container.appendChild(card);
    });

    document.querySelectorAll('.adicionar-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const id = e.target.dataset.id;
        const nome = e.target.dataset.nome;
        const preco = parseFloat(e.target.dataset.preco);
        adicionarAoCarrinho(id, nome, preco);
      });
    });
  }

  // ... (Mantenha o resto das suas fun√ß√µes: renderizarMesas, adicionarAoCarrinho, etc., como estavam)
  // Certifique-se de que as fun√ß√µes getProducts(), getMesas() e postPedido() existam no seu arquivo api.js
</script>

<script>
  let carrinho = {};
  let allProducts = [];

  if (localStorage.getItem('catcafe-carrinho')) {
    carrinho = JSON.parse(localStorage.getItem('catcafe-carrinho'));
  }

  function salvarCarrinho() {
    localStorage.setItem('catcafe-carrinho', JSON.stringify(carrinho));
  }

  function formatarPreco(valor) {
    return 'R$ ' + valor.toFixed(2).replace('.', ',');
  }

  async function renderizarMesas() {
      const select = document.getElementById('mesa-select');
      select.innerHTML = '<option>Carregando mesas...</option>';
      const mesas = await getMesas();
      select.innerHTML = '';
      if (mesas === null || mesas.length === 0) {
          select.innerHTML = '<option>Nenhuma mesa dispon√≠vel</option>';
          return;
      }
      mesas.forEach(mesa => {
          const option = document.createElement('option');
          option.value = mesa.id;
          option.textContent = "Mesa " + mesa.numero;
          select.appendChild(option);
      });
  }

  function adicionarAoCarrinho(id, nome, preco) {
    if (carrinho[id]) { carrinho[id].quantidade++; } 
    else { carrinho[id] = { id: id, nome: nome, quantidade: 1, preco: preco }; }
    salvarCarrinho();
    renderizarCarrinho();
  }

  function incrementarItem(id) {
    if (carrinho[id]) { carrinho[id].quantidade++; salvarCarrinho(); renderizarCarrinho(); }
  }

  function decrementarItem(id) {
    if (carrinho[id]) {
      carrinho[id].quantidade--;
      if (carrinho[id].quantidade <= 0) { delete carrinho[id]; }
      salvarCarrinho(); renderizarCarrinho();
    }
  }

  function removerItem(id) {
    if (carrinho[id]) { delete carrinho[id]; salvarCarrinho(); renderizarCarrinho(); }
  }

  function renderizarCarrinho() {
    const tbody = document.getElementById('carrinho-corpo');
    tbody.innerHTML = '';
    let total = 0;

    for (let id in carrinho) {
      const item = carrinho[id];
      const subtotal = item.quantidade * item.preco;
      total += subtotal;
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="py-4 px-4 font-medium">${item.nome}</td>
        <td>${item.quantidade}</td>
        <td class="font-bold">${formatarPreco(subtotal)}</td>
        <td class="space-x-3">
          <button class="incrementar-btn text-blue-600 text-xl" data-id="${id}">+</button>
          <button class="decrementar-btn text-warm-orange text-xl" data-id="${id}">-</button>
          <button class="remover-btn text-brand-primary" data-id="${id}"><i class="fas fa-trash-alt"></i></button>
        </td>
      `;
      tbody.appendChild(tr);
    }

    if (Object.keys(carrinho).length === 0) {
      tbody.innerHTML = '<tr><td colspan="4" class="py-8 text-gray-400 italic">Seu carrinho est√° vazio</td></tr>';
    }

    document.getElementById('total-carrinho').innerText = `Total: ${formatarPreco(total)}`;

    document.querySelectorAll('.incrementar-btn').forEach(btn => btn.onclick = (e) => incrementarItem(e.target.dataset.id));
    document.querySelectorAll('.decrementar-btn').forEach(btn => btn.onclick = (e) => decrementarItem(e.target.dataset.id));
    document.querySelectorAll('.remover-btn').forEach(btn => btn.onclick = (e) => removerItem(e.target.closest('button').dataset.id));
  }

  document.getElementById('confirmar-pedido').onclick = async () => {
    if (Object.keys(carrinho).length === 0) return alert('Carrinho vazio!');
    const mesaId = document.getElementById('mesa-select').value;
    const items = Object.values(carrinho).map(item => ({
        quantidade: item.quantidade,
        price: item.preco,
        produto: allProducts.find(p => p.id == item.id)
    }));

    try {
        const res = await postPedido({ mesa: { id: mesaId }, items: items, status: 'SUBMETIDO' });
        alert('Pedido realizado com sucesso!');
        carrinho = {}; salvarCarrinho(); renderizarCarrinho();
    } catch (e) { alert('Erro ao processar pedido.'); }
  };

  renderizarCardapio();
  renderizarCarrinho();
  renderizarMesas();
</script>

</body>
</html>
